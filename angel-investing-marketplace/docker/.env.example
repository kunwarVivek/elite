# ============================================================================
# Angel Investing Marketplace - Docker Environment Configuration
# ============================================================================
#
# This file contains ALL environment variables required for Docker deployment.
# Copy this file to .env and customize values for your environment.
#
# SECURITY WARNING: DO NOT use these example values in production!
# Generate strong, unique secrets using the provided scripts.
#
# For development: ./scripts/generate-dev-secrets.sh
# For production: ./secrets/generate-secrets.sh
#
# ============================================================================

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================

# PostgreSQL Database Name
# The name of the database to create and connect to
POSTGRES_DB=angel_investing_marketplace

# PostgreSQL User (Development Only)
# In production, this is managed via secrets
POSTGRES_USER=postgres

# PostgreSQL Password (Development Only)
# In production, use postgres_password.txt secret file
# REQUIRED: Must be at least 12 characters
POSTGRES_PASSWORD=postgres

# Database URL (Development Only)
# In production, use database_url.txt secret file
# Format: postgresql://username:password@host:port/database
DATABASE_URL=postgresql://postgres:postgres@postgres:5432/angel_investing_marketplace

# ============================================================================
# REDIS CONFIGURATION
# ============================================================================

# Redis Connection URL (Development Only)
# In production, use redis_url.txt secret file
# Format: redis://[:password@]host:port
# Used for: Session storage, caching, BullMQ job queues
REDIS_URL=redis://redis:6379

# Redis Password (Development Only)
# In production, use redis_password.txt secret file
# Leave empty for development (no password)
REDIS_PASSWORD=

# ============================================================================
# APPLICATION CONFIGURATION
# ============================================================================

# Node Environment
# Values: development | production | test
NODE_ENV=production

# Backend API Port
# Port the backend server listens on inside the container
PORT=3001

# Frontend Application URL
# Full URL where the frontend is accessible
# Used for CORS configuration and redirects
FRONTEND_URL=http://localhost:3000

# API Base URL
# Full URL where the backend API is accessible
# Used by frontend for API requests
API_BASE_URL=http://localhost:3001

# WebSocket URL
# URL for real-time WebSocket connections
# Used for: Live portfolio updates, notifications, chat
WEBSOCKET_URL=http://localhost:3001

# ============================================================================
# AUTHENTICATION & SECURITY
# ============================================================================

# Better Auth Configuration
# Better Auth is used for authentication and session management
# In production, use better_auth_secret.txt secret file
BETTER_AUTH_SECRET=your-super-secret-key-here-min-32-chars
BETTER_AUTH_URL=http://localhost:3001

# JWT Secret Key
# Used for signing and verifying JWT tokens
# In production, use jwt_secret.txt secret file
# REQUIRED: Minimum 64 characters, 512 bits of entropy
JWT_SECRET=your-jwt-secret-key-here-min-64-chars-production-use-openssl-rand

# JWT Token Expiration
# How long JWT access tokens remain valid
# Format: 1h, 7d, 30d
JWT_EXPIRES_IN=7d

# Encryption Key
# Used for encrypting sensitive data at rest (SSN, bank account numbers)
# In production, use encryption_key.txt secret file
# REQUIRED: 32 bytes (256 bits) of entropy
ENCRYPTION_KEY=your-encryption-key-32-chars-min

# Password Hashing Rounds
# Number of bcrypt rounds for password hashing
# Higher = more secure but slower (10-12 recommended)
BCRYPT_ROUNDS=12

# Session Configuration
# Session duration before requiring re-authentication
SESSION_DURATION=7d
SESSION_COOKIE_NAME=angel_investing_session
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=strict

# ============================================================================
# PAYMENT PROCESSING (STRIPE)
# ============================================================================

# Stripe API Keys
# Get from: https://dashboard.stripe.com/apikeys
# Use test keys (pk_test_*, sk_test_*) for development
# Use live keys (pk_live_*, sk_live_*) for production

# Stripe Publishable Key (Frontend)
# Safe to expose in client-side code
STRIPE_PUBLISHABLE_KEY=pk_test_your_stripe_publishable_key_here

# Stripe Secret Key (Backend)
# In production, use stripe_secret_key.txt secret file
# NEVER expose this in client-side code
STRIPE_SECRET_KEY=sk_test_your_stripe_secret_key_here

# Stripe Webhook Secret
# In production, use stripe_webhook_secret.txt secret file
# Get from: https://dashboard.stripe.com/webhooks
# Used to verify webhook signatures
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret_here

# Payment Configuration
# Platform fee percentage (0-100)
PLATFORM_FEE_PERCENTAGE=5

# Syndicate lead carry percentage (0-100)
SYNDICATE_FEE_PERCENTAGE=20

# Minimum investment amount in cents ($1.00 = 100)
MINIMUM_INVESTMENT_AMOUNT=10000

# Maximum investment amount in cents ($1,000,000 = 100000000)
MAXIMUM_INVESTMENT_AMOUNT=100000000

# Escrow Configuration
# How long funds are held in escrow before release (days)
ESCROW_HOLD_PERIOD_DAYS=30

# Refund window after investment (days)
REFUND_WINDOW_DAYS=7

# ============================================================================
# BANKING & VERIFICATION (PLAID)
# ============================================================================

# Plaid API Credentials
# Get from: https://dashboard.plaid.com/team/keys
# Used for: Bank account verification, ACH transfers

# Plaid Client ID
PLAID_CLIENT_ID=your_plaid_client_id_here

# Plaid Secret
# In production, use plaid_secret.txt secret file
PLAID_SECRET=your_plaid_secret_here

# Plaid Environment
# Values: sandbox | development | production
# Use 'sandbox' for testing with fake accounts
PLAID_ENV=sandbox

# KYC/AML Configuration
# Threshold amounts for verification requirements

# Investment amount requiring KYC verification (cents)
KYC_VERIFICATION_THRESHOLD=1000000

# Investment amount requiring AML screening (cents)
AML_SCREENING_THRESHOLD=5000000

# ============================================================================
# FILE STORAGE (CLOUDFLARE R2 / AWS S3)
# ============================================================================

# Storage Provider
# Values: cloudflare_r2 | aws_s3
STORAGE_PROVIDER=cloudflare_r2

# Cloudflare R2 Configuration
# Get from: Cloudflare Dashboard → R2 → Manage R2 API Tokens

# R2 Account ID
CLOUDFLARE_R2_ACCOUNT_ID=your_cloudflare_account_id

# R2 Access Key ID
# In production, use cloudflare_r2_access_key.txt secret file
CLOUDFLARE_R2_ACCESS_KEY=your_r2_access_key_here

# R2 Secret Access Key
# In production, use cloudflare_r2_secret_key.txt secret file
CLOUDFLARE_R2_SECRET_KEY=your_r2_secret_key_here

# R2 Bucket Name
CLOUDFLARE_R2_BUCKET_NAME=angel-investing-uploads

# R2 Public URL (optional, for public assets)
CLOUDFLARE_R2_PUBLIC_URL=https://uploads.yourdomain.com

# AWS S3 Configuration (Alternative to R2)
# Get from: AWS IAM → Users → Security Credentials

# AWS Access Key ID
# In production, use aws_access_key_id.txt secret file
AWS_ACCESS_KEY_ID=your_aws_access_key_id

# AWS Secret Access Key
# In production, use aws_secret_access_key.txt secret file
AWS_SECRET_ACCESS_KEY=your_aws_secret_access_key

# AWS Region
AWS_REGION=us-east-1

# S3 Bucket Name
S3_BUCKET_NAME=angel-investing-uploads

# File Upload Limits
# Maximum file size for uploads (bytes)
MAX_FILE_SIZE=10485760

# Allowed file types (comma-separated)
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/gif,application/pdf,application/msword

# ============================================================================
# EMAIL SERVICE
# ============================================================================

# Email Provider
# Values: smtp | sendgrid | mailgun | postmark
EMAIL_PROVIDER=smtp

# SMTP Configuration (for Gmail, Outlook, etc.)
# Get app password from: https://myaccount.google.com/apppasswords

# SMTP Host
SMTP_HOST=smtp.gmail.com

# SMTP Port (587 for TLS, 465 for SSL)
SMTP_PORT=587

# SMTP Secure (true for SSL, false for TLS)
SMTP_SECURE=false

# SMTP Username
SMTP_USER=your-email@gmail.com

# SMTP Password
# In production, use smtp_pass.txt secret file
SMTP_PASS=your-app-password-here

# Email From Address
EMAIL_FROM=noreply@angelinvesting.market
EMAIL_FROM_NAME=Angel Investing Marketplace

# SendGrid Configuration (Alternative)
# Get API key from: https://app.sendgrid.com/settings/api_keys
# In production, use sendgrid_api_key.txt secret file
SENDGRID_API_KEY=your_sendgrid_api_key_here

# Mailgun Configuration (Alternative)
# Get from: https://app.mailgun.com/app/account/security/api_keys
# In production, use mailgun_api_key.txt secret file
MAILGUN_API_KEY=your_mailgun_api_key_here
MAILGUN_DOMAIN=mg.yourdomain.com

# Email Service API Key (Generic)
# In production, use email_service_api_key.txt secret file
EMAIL_SERVICE_API_KEY=your_email_service_api_key_here

# ============================================================================
# MONITORING & LOGGING
# ============================================================================

# Log Level
# Values: error | warn | info | debug | trace
LOG_LEVEL=info

# Log Format
# Values: json | pretty
LOG_FORMAT=json

# Sentry Configuration (Error Tracking)
# Get from: https://sentry.io/settings/projects/
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_ENVIRONMENT=production

# Grafana Admin Password
# In production, use grafana_admin_password.txt secret file
GRAFANA_ADMIN_PASSWORD=admin

# Prometheus Configuration
# Metrics scrape interval
PROMETHEUS_SCRAPE_INTERVAL=15s

# Metrics retention period
PROMETHEUS_RETENTION=200h

# Alert Manager Configuration
# Email for receiving alerts
ALERT_EMAIL=alerts@yourdomain.com

# Slack Webhook URL for alerts
# In production, use slack_webhook.txt secret file
SLACK_WEBHOOK=https://hooks.slack.com/services/YOUR/WEBHOOK/URL

# PagerDuty Integration Key
# In production, use pagerduty_routing_key.txt secret file
PAGERDUTY_ROUTING_KEY=your_pagerduty_routing_key_here

# ============================================================================
# RATE LIMITING & SECURITY
# ============================================================================

# Rate Limiting Configuration
# Maximum requests per IP per window
RATE_LIMIT_MAX_REQUESTS=100

# Rate limit window (milliseconds)
RATE_LIMIT_WINDOW_MS=900000

# CORS Configuration
# Allowed origins (comma-separated)
CORS_ORIGINS=http://localhost:3000,https://yourdomain.com

# CORS Credentials
CORS_CREDENTIALS=true

# Security Headers
# Enable HSTS (HTTP Strict Transport Security)
HSTS_ENABLED=true
HSTS_MAX_AGE=31536000

# Content Security Policy
CSP_ENABLED=true

# ============================================================================
# DOMAIN CONFIGURATION (PRODUCTION)
# ============================================================================

# Primary Domain
DOMAIN=angelinvesting.market

# API Subdomain
API_DOMAIN=api.angelinvesting.market

# WebSocket Subdomain (optional)
WS_DOMAIN=ws.angelinvesting.market

# SSL/TLS Configuration
SSL_ENABLED=true
SSL_CERT_PATH=/etc/ssl/fullchain.pem
SSL_KEY_PATH=/etc/ssl/privkey.pem

# ============================================================================
# FEATURE FLAGS
# ============================================================================

# Enable/disable features for gradual rollout
# Values: true | false

# Enable secondary marketplace trading
FEATURE_SECONDARY_MARKETPLACE=true

# Enable syndicate/group investing
FEATURE_SYNDICATES=true

# Enable social features (news feed, discussions)
FEATURE_SOCIAL=true

# Enable mobile app API endpoints
FEATURE_MOBILE_API=true

# Enable advanced analytics
FEATURE_ANALYTICS=true

# Enable WebSocket real-time updates
FEATURE_WEBSOCKETS=true

# ============================================================================
# THIRD-PARTY INTEGRATIONS
# ============================================================================

# Google Analytics
GOOGLE_ANALYTICS_ID=G-XXXXXXXXXX

# Google Tag Manager
GOOGLE_TAG_MANAGER_ID=GTM-XXXXXXX

# Facebook Pixel
FACEBOOK_PIXEL_ID=your_pixel_id

# Intercom (Customer Support)
INTERCOM_APP_ID=your_intercom_app_id

# Segment (Analytics)
SEGMENT_WRITE_KEY=your_segment_write_key

# ============================================================================
# DEPLOYMENT & INFRASTRUCTURE
# ============================================================================

# Deployment Environment
DEPLOYMENT_ENV=production

# Container Registry
CONTAINER_REGISTRY=ghcr.io/yourorg

# Image Tag
IMAGE_TAG=latest

# Number of Backend Replicas
BACKEND_REPLICAS=2

# Number of Frontend Replicas
FRONTEND_REPLICAS=2

# Resource Limits (Production)
# Backend
BACKEND_CPU_LIMIT=1.0
BACKEND_MEMORY_LIMIT=1G
BACKEND_CPU_RESERVATION=0.5
BACKEND_MEMORY_RESERVATION=512M

# Frontend
FRONTEND_CPU_LIMIT=0.5
FRONTEND_MEMORY_LIMIT=256M
FRONTEND_CPU_RESERVATION=0.25
FRONTEND_MEMORY_RESERVATION=128M

# Database
POSTGRES_CPU_LIMIT=0.50
POSTGRES_MEMORY_LIMIT=512M
POSTGRES_CPU_RESERVATION=0.25
POSTGRES_MEMORY_RESERVATION=256M

# Redis
REDIS_CPU_LIMIT=0.25
REDIS_MEMORY_LIMIT=256M
REDIS_CPU_RESERVATION=0.10
REDIS_MEMORY_RESERVATION=128M

# ============================================================================
# NOTES
# ============================================================================
#
# REQUIRED VARIABLES:
# - All database variables (POSTGRES_*, DATABASE_URL)
# - All Redis variables (REDIS_URL)
# - All authentication variables (JWT_SECRET, ENCRYPTION_KEY)
# - Stripe keys (for payment processing)
# - Email configuration (SMTP or provider API key)
# - File storage credentials (Cloudflare R2 or AWS S3)
#
# OPTIONAL VARIABLES:
# - Monitoring and logging (can use defaults)
# - Feature flags (can use defaults)
# - Third-party integrations (not required for core functionality)
#
# VALIDATION RULES:
# - JWT_SECRET: Minimum 64 characters
# - ENCRYPTION_KEY: Exactly 32 characters (256 bits)
# - POSTGRES_PASSWORD: Minimum 12 characters
# - Email addresses: Must be valid format
# - URLs: Must include protocol (http:// or https://)
# - Ports: Must be 1-65535
# - Percentages: Must be 0-100
#
# EXTERNAL SERVICE SETUP:
# - Stripe: https://dashboard.stripe.com/register
# - Plaid: https://dashboard.plaid.com/signup
# - Cloudflare R2: https://dash.cloudflare.com/sign-up
# - SendGrid: https://signup.sendgrid.com/
# - Sentry: https://sentry.io/signup/
#
# ============================================================================
